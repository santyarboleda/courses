<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Conteo de palabras en Python usando Hadoop Streaming (Python avanzado) &mdash; documentación de Python, Big data, Machine Learning y Cloud Computing - 0.1</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Python, Big data, Machine Learning y Cloud Computing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Temas:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../handling_data.html">Manipulación de datos usando Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../big_data.html">Big Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../machine_learning.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cloud_computing.html">Cloud Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_visualization.html">Data Visualization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Python, Big data, Machine Learning y Cloud Computing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Conteo de palabras en Python usando Hadoop Streaming (Python avanzado)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/big_data/hadoop/notebooks/1-04_.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Conteo-de-palabras-en-Python-usando-Hadoop-Streaming-(Python-avanzado)">
<h1>Conteo de palabras en Python usando Hadoop Streaming (Python avanzado)<a class="headerlink" href="#Conteo-de-palabras-en-Python-usando-Hadoop-Streaming-(Python-avanzado)" title="Enlace permanente a este encabezado"></a></h1>
<ul class="simple">
<li><p>Última modificación: Noviembre 03, 2019</p></li>
</ul>
<section id="Definición-del-problema">
<h2>Definición del problema<a class="headerlink" href="#Definición-del-problema" title="Enlace permanente a este encabezado"></a></h2>
<p>Se desea contar la frecuencia de ocurrencia de palabras en un conjunto de documentos. Debido a los requerimientos de diseño (gran volúmen de datos y tiempos rápidos de respuesta) se desea implementar una arquitectura Big Data. Se desea implementar una <strong>solución computacional eficiente</strong> en <strong>Python</strong>.</p>
<p>A continuación se generarán tres archivos de prueba para probar el sistema.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Se crea el directorio de entrada</span>
<span class="c1">#</span>
<span class="o">!</span>rm<span class="w"> </span>-rf<span class="w"> </span>/tmp/wordcount
<span class="o">!</span>mkdir<span class="w"> </span>-p<span class="w"> </span>/tmp/wordcount/input
<span class="o">%</span><span class="k">cd</span> /tmp/wordcount
<span class="o">!</span>ls
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/tmp/wordcount
input
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> input/text0.txt
<span class="n">Analytics</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">discovery</span><span class="p">,</span> <span class="n">interpretation</span><span class="p">,</span> <span class="ow">and</span> <span class="n">communication</span> <span class="n">of</span> <span class="n">meaningful</span> <span class="n">patterns</span>
<span class="ow">in</span> <span class="n">data</span><span class="o">.</span> <span class="n">Especially</span> <span class="n">valuable</span> <span class="ow">in</span> <span class="n">areas</span> <span class="n">rich</span> <span class="k">with</span> <span class="n">recorded</span> <span class="n">information</span><span class="p">,</span> <span class="n">analytics</span> <span class="n">relies</span>
<span class="n">on</span> <span class="n">the</span> <span class="n">simultaneous</span> <span class="n">application</span> <span class="n">of</span> <span class="n">statistics</span><span class="p">,</span> <span class="n">computer</span> <span class="n">programming</span> <span class="ow">and</span> <span class="n">operations</span> <span class="n">research</span>
<span class="n">to</span> <span class="n">quantify</span> <span class="n">performance</span><span class="o">.</span>

<span class="n">Organizations</span> <span class="n">may</span> <span class="n">apply</span> <span class="n">analytics</span> <span class="n">to</span> <span class="n">business</span> <span class="n">data</span> <span class="n">to</span> <span class="n">describe</span><span class="p">,</span> <span class="n">predict</span><span class="p">,</span> <span class="ow">and</span> <span class="n">improve</span> <span class="n">business</span>
<span class="n">performance</span><span class="o">.</span> <span class="n">Specifically</span><span class="p">,</span> <span class="n">areas</span> <span class="n">within</span> <span class="n">analytics</span> <span class="n">include</span> <span class="n">predictive</span> <span class="n">analytics</span><span class="p">,</span> <span class="n">prescriptive</span>
<span class="n">analytics</span><span class="p">,</span> <span class="n">enterprise</span> <span class="n">decision</span> <span class="n">management</span><span class="p">,</span> <span class="n">descriptive</span> <span class="n">analytics</span><span class="p">,</span> <span class="n">cognitive</span> <span class="n">analytics</span><span class="p">,</span> <span class="n">Big</span>
<span class="n">Data</span> <span class="n">Analytics</span><span class="p">,</span> <span class="n">retail</span> <span class="n">analytics</span><span class="p">,</span> <span class="n">store</span> <span class="n">assortment</span> <span class="ow">and</span> <span class="n">stock</span><span class="o">-</span><span class="n">keeping</span> <span class="n">unit</span> <span class="n">optimization</span><span class="p">,</span>
<span class="n">marketing</span> <span class="n">optimization</span> <span class="ow">and</span> <span class="n">marketing</span> <span class="n">mix</span> <span class="n">modeling</span><span class="p">,</span> <span class="n">web</span> <span class="n">analytics</span><span class="p">,</span> <span class="n">call</span> <span class="n">analytics</span><span class="p">,</span> <span class="n">speech</span>
<span class="n">analytics</span><span class="p">,</span> <span class="n">sales</span> <span class="n">force</span> <span class="n">sizing</span> <span class="ow">and</span> <span class="n">optimization</span><span class="p">,</span> <span class="n">price</span> <span class="ow">and</span> <span class="n">promotion</span> <span class="n">modeling</span><span class="p">,</span> <span class="n">predictive</span>
<span class="n">science</span><span class="p">,</span> <span class="n">credit</span> <span class="n">risk</span> <span class="n">analysis</span><span class="p">,</span> <span class="ow">and</span> <span class="n">fraud</span> <span class="n">analytics</span><span class="o">.</span> <span class="n">Since</span> <span class="n">analytics</span> <span class="n">can</span> <span class="n">require</span> <span class="n">extensive</span>
<span class="n">computation</span> <span class="p">(</span><span class="n">see</span> <span class="n">big</span> <span class="n">data</span><span class="p">),</span> <span class="n">the</span> <span class="n">algorithms</span> <span class="ow">and</span> <span class="n">software</span> <span class="n">used</span> <span class="k">for</span> <span class="n">analytics</span> <span class="n">harness</span> <span class="n">the</span> <span class="n">most</span>
<span class="n">current</span> <span class="n">methods</span> <span class="ow">in</span> <span class="n">computer</span> <span class="n">science</span><span class="p">,</span> <span class="n">statistics</span><span class="p">,</span> <span class="ow">and</span> <span class="n">mathematics</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing input/text0.txt
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> input/text1.txt
<span class="n">The</span> <span class="n">field</span> <span class="n">of</span> <span class="n">data</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Analytics</span> <span class="n">often</span> <span class="n">involves</span> <span class="n">studying</span> <span class="n">past</span> <span class="n">historical</span> <span class="n">data</span> <span class="n">to</span>
<span class="n">research</span> <span class="n">potential</span> <span class="n">trends</span><span class="p">,</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">the</span> <span class="n">effects</span> <span class="n">of</span> <span class="n">certain</span> <span class="n">decisions</span> <span class="ow">or</span> <span class="n">events</span><span class="p">,</span> <span class="ow">or</span> <span class="n">to</span>
<span class="n">evaluate</span> <span class="n">the</span> <span class="n">performance</span> <span class="n">of</span> <span class="n">a</span> <span class="n">given</span> <span class="n">tool</span> <span class="ow">or</span> <span class="n">scenario</span><span class="o">.</span> <span class="n">The</span> <span class="n">goal</span> <span class="n">of</span> <span class="n">analytics</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">improve</span>
<span class="n">the</span> <span class="n">business</span> <span class="n">by</span> <span class="n">gaining</span> <span class="n">knowledge</span> <span class="n">which</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">make</span> <span class="n">improvements</span> <span class="ow">or</span> <span class="n">changes</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing input/text1.txt
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> input/text2.txt
<span class="n">Data</span> <span class="n">analytics</span> <span class="p">(</span><span class="n">DA</span><span class="p">)</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">process</span> <span class="n">of</span> <span class="n">examining</span> <span class="n">data</span> <span class="n">sets</span> <span class="ow">in</span> <span class="n">order</span> <span class="n">to</span> <span class="n">draw</span> <span class="n">conclusions</span>
<span class="n">about</span> <span class="n">the</span> <span class="n">information</span> <span class="n">they</span> <span class="n">contain</span><span class="p">,</span> <span class="n">increasingly</span> <span class="k">with</span> <span class="n">the</span> <span class="n">aid</span> <span class="n">of</span> <span class="n">specialized</span> <span class="n">systems</span>
<span class="ow">and</span> <span class="n">software</span><span class="o">.</span> <span class="n">Data</span> <span class="n">analytics</span> <span class="n">technologies</span> <span class="ow">and</span> <span class="n">techniques</span> <span class="n">are</span> <span class="n">widely</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">commercial</span>
<span class="n">industries</span> <span class="n">to</span> <span class="n">enable</span> <span class="n">organizations</span> <span class="n">to</span> <span class="n">make</span> <span class="n">more</span><span class="o">-</span><span class="n">informed</span> <span class="n">business</span> <span class="n">decisions</span> <span class="ow">and</span> <span class="n">by</span>
<span class="n">scientists</span> <span class="ow">and</span> <span class="n">researchers</span> <span class="n">to</span> <span class="n">verify</span> <span class="ow">or</span> <span class="n">disprove</span> <span class="n">scientific</span> <span class="n">models</span><span class="p">,</span> <span class="n">theories</span> <span class="ow">and</span>
<span class="n">hypotheses</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing input/text2.txt
</pre></div></div>
</div>
</section>
<section id="Paso-1-—-Implementación-del-mapper">
<h2>Paso 1 — Implementación del mapper<a class="headerlink" href="#Paso-1-—-Implementación-del-mapper" title="Enlace permanente a este encabezado"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> mapper.py
<span class="ch">#! /usr/bin/python3</span>

<span class="c1">#</span>
<span class="c1"># Esta es la funcion que mapea la entrada a parejas (clave, valor)</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="c1">#</span>
<span class="c1"># Se usa una clase iterable para implementar el mapper.</span>
<span class="c1">#</span>
<span class="k">class</span> <span class="nc">Mapper</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="c1">#</span>
        <span class="c1"># almacena el flujo de entrada como una variable del objeto</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span>

    <span class="k">def</span> <span class="nf">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1">#</span>
        <span class="c1"># escribe al flujo estandar de salida</span>
        <span class="c1">#</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="c1">#</span>
        <span class="c1"># imprime un reporte en el flujo de error</span>
        <span class="c1"># no se debe usar el stdout, ya que en este</span>
        <span class="c1"># unicamente deben ir las parejas (key, value)</span>
        <span class="c1">#</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;reporter:status:</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">counter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s2">&quot;ApplicationCounter&quot;</span><span class="p">):</span>
        <span class="c1">#</span>
        <span class="c1"># imprime el valor del contador</span>
        <span class="c1">#</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;reporter:counter:</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="n">amount</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">word_counter</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1">#</span>
        <span class="c1"># imprime un mensaje a la entrada</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="s1">&#39;Iniciando procesamiento &#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="c1">#</span>
            <span class="c1"># cuenta la cantidad de palabras procesadas</span>
            <span class="c1">#</span>
            <span class="n">word_counter</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1">#</span>
            <span class="c1"># por cada palabra del flujo de datos</span>
            <span class="c1"># emite la pareja (word, 1)</span>
            <span class="c1">#</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">word</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1"># imprime un mensaje a la salida</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">(</span><span class="s1">&#39;num_words&#39;</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="n">word_counter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="s1">&#39;Finalizadno procesamiento &#39;</span><span class="p">)</span>




    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#</span>
        <span class="c1"># itera sobre cada linea de codigo recibida</span>
        <span class="c1"># a traves del flujo de entrada</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">:</span>
            <span class="c1">#</span>
            <span class="c1"># itera sobre cada palabra de la linea</span>
            <span class="c1"># (en los ciclos for, retorna las palabras</span>
            <span class="c1"># una a una)</span>
            <span class="c1">#</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="c1">#</span>
                <span class="c1"># retorna la palabra siguiente en el ciclo for</span>
                <span class="c1">#</span>
                <span class="k">yield</span> <span class="n">word</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1">#</span>
    <span class="c1"># inicializa el objeto con el flujo de entrada</span>
    <span class="c1">#</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># ejecuta el mapper</span>
    <span class="c1">#</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">map</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing mapper.py
</pre></div></div>
</div>
</section>
<section id="Paso-2-—-Verificación">
<h2>Paso 2 — Verificación<a class="headerlink" href="#Paso-2-—-Verificación" title="Enlace permanente a este encabezado"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># El programa anterior se hace ejecutable</span>
<span class="c1">#</span>
<span class="o">!</span>chmod<span class="w"> </span>+x<span class="w"> </span>/tmp/mapper.py
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># la salida de la función anterior es:</span>
<span class="c1">#</span>
<span class="o">!</span>cat<span class="w"> </span>input/text*.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>mapper.py<span class="w"> </span><span class="p">|</span><span class="w"> </span>head
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
reporter:status:Iniciando procesamiento
reporter:counter:ApplicationCounter,num_words,252
reporter:status:Finalizadno procesamiento
Analytics       1
is      1
the     1
discovery,      1
interpretation, 1
and     1
communication   1
of      1
meaningful      1
patterns        1
</pre></div></div>
</div>
</section>
<section id="Paso-3-—--Implementación-del-Reducer">
<h2>Paso 3 —- Implementación del Reducer<a class="headerlink" href="#Paso-3-—--Implementación-del-Reducer" title="Enlace permanente a este encabezado"></a></h2>
<p>El reducer recibe las parejas (key, value) a través del flujo de salida. En los ejemplos anteriores, el reducer verifica si la clave cambia de un elemento al siguiente. Sin embargo, resulta más eficiente que se pueda iterar directamente sobre elementos consecutivos que tienen la misma clave. La función <code class="docutils literal notranslate"><span class="pre">groupby</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">itertools</span></code> permite hacer esto. Dicha función recibe como argumentos los datos y una función que genera la clave para cada dato. Retorna una tupla con la clave y los
elementos consecutivos que contienen la misma clave. El siguiente ejemplo permite clarificar su operación.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>

<span class="c1">#</span>
<span class="c1"># la letra es la clave y los números son los valores</span>
<span class="c1">#</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">,</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span>

<span class="c1">#</span>
<span class="c1"># retorna la parte correspondiente a la clave</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">keyfun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">k</span>

<span class="c1">#</span>
<span class="c1"># itera sobre la clave y los elementos que contiene la misma clave</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">keyfun</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
A
    (&#39;A&#39;, 1)
B
    (&#39;B&#39;, 10)
A
    (&#39;A&#39;, 2)
    (&#39;A&#39;, 3)
    (&#39;A&#39;, 4)
B
    (&#39;B&#39;, 20)
</pre></div></div>
</div>
<p>A continuación se modifica el reducer para incoporar el uso de clases y de la función <code class="docutils literal notranslate"><span class="pre">groupby</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> reducer.py
<span class="ch">#! /usr/bin/python3</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">class</span> <span class="nc">Reducer</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span>

    <span class="k">def</span> <span class="nf">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#</span>
        <span class="c1"># Esta funcion reduce los elementos que</span>
        <span class="c1"># tienen la misma clave</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">val</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">total</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">:</span>
            <span class="c1">#</span>
            <span class="c1"># Lee el stream de datos y lo parte</span>
            <span class="c1"># en (clave, valor)</span>
            <span class="c1">#</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

            <span class="c1">#</span>
            <span class="c1"># retorna la tupla (clave, valor)</span>
            <span class="c1"># como el siguiente elemento del ciclo for</span>
            <span class="c1">#</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="n">reducer</span> <span class="o">=</span> <span class="n">Reducer</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>
    <span class="n">reducer</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing reducer.py
</pre></div></div>
</div>
</section>
<section id="Paso-4">
<h2>Paso 4<a class="headerlink" href="#Paso-4" title="Enlace permanente a este encabezado"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Se hace ejecutable el archivo</span>
<span class="c1">#</span>
<span class="o">!</span>chmod<span class="w"> </span>+x<span class="w"> </span>reducer.py
</pre></div>
</div>
</div>
</section>
<section id="Paso-5">
<h2>Paso 5<a class="headerlink" href="#Paso-5" title="Enlace permanente a este encabezado"></a></h2>
<p>Se prueba la implementación localmente.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># La función sort hace que todos los elementos con</span>
<span class="c1"># la misma clave queden en lineas consecutivas.</span>
<span class="c1"># Hace el papel del módulo Shuffle &amp; Sort</span>
<span class="c1">#</span>
<span class="o">!</span>cat<span class="w"> </span>input/text*.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>mapper.py<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>reducer.py<span class="w"> </span><span class="p">|</span><span class="w"> </span>head
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
reporter:status:Iniciando procesamiento
reporter:counter:ApplicationCounter,num_words,252
reporter:status:Finalizadno procesamiento
(DA)    1
(see    1
Analytics       2
Analytics,      1
Big     1
Data    3
Especially      1
Organizations   1
Since   1
Specifically,   1
</pre></div></div>
</div>
</section>
<section id="Paso-6-—-Movimiento-de-los-archivos-al-HDFS">
<h2>Paso 6 — Movimiento de los archivos al HDFS<a class="headerlink" href="#Paso-6-—-Movimiento-de-los-archivos-al-HDFS" title="Enlace permanente a este encabezado"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-mkdir<span class="w"> </span>input
<span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-copyFromLocal<span class="w"> </span>input/*<span class="w"> </span>input
<span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-ls<span class="w"> </span>input/*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-rw-r--r--   1 root supergroup       1093 2022-05-26 02:31 input/text0.txt
-rw-r--r--   1 root supergroup        352 2022-05-26 02:31 input/text1.txt
-rw-r--r--   1 root supergroup        440 2022-05-26 02:31 input/text2.txt
</pre></div></div>
</div>
</section>
<section id="Paso-7">
<h2>Paso 7<a class="headerlink" href="#Paso-7" title="Enlace permanente a este encabezado"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%writefile app.sh
#
# Se ejecuta en Hadoop.
#   -input: archivo de entrada
#   -output: directorio de salida
#   -maper: programa que ejecuta el map
#   -reducer: programa que ejecuta la reducción
#
hadoop jar \
    $HADOOP_HOME/share/hadoop/tools/lib/hadoop-streaming-*.jar \
    -files mapper.py,reducer.py  \
    -input input  \
    -output output \
    -mapper mapper.py \
    -reducer reducer.py
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing app.sh
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>bash<span class="w"> </span>app.sh
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
packageJobJar: [/tmp/hadoop-unjar5327758262618317368/] [] /tmp/streamjob4110569942363235024.jar tmpDir=null
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Contenido del directorio con los resultados de la corrida</span>
<span class="c1">#</span>
<span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-ls<span class="w"> </span>output
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 2 items
-rw-r--r--   1 root supergroup          0 2022-05-26 02:32 output/_SUCCESS
-rw-r--r--   1 root supergroup       1649 2022-05-26 02:32 output/part-00000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Contenido del directorio con los resultados de la corrida</span>
<span class="c1">#</span>
<span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-ls<span class="w"> </span>output
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 2 items
-rw-r--r--   1 root supergroup          0 2022-05-26 02:32 output/_SUCCESS
-rw-r--r--   1 root supergroup       1649 2022-05-26 02:32 output/part-00000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Se visualiza el archivo con los resultados de la corrida</span>
<span class="c1">#</span>
<span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-cat<span class="w"> </span>output/part-00000<span class="w"> </span><span class="p">|</span><span class="w"> </span>head
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(DA)    1
(see    1
Analytics       2
Analytics,      1
Big     1
Data    3
Especially      1
Organizations   1
Since   1
Specifically,   1
</pre></div></div>
</div>
</section>
<section id="Paso-8-—-Movimiento-de-los-resultados-al-sistema-local">
<h2>Paso 8 — Movimiento de los resultados al sistema local<a class="headerlink" href="#Paso-8-—-Movimiento-de-los-resultados-al-sistema-local" title="Enlace permanente a este encabezado"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-copyToLocal<span class="w"> </span>output<span class="w"> </span>output
<span class="o">!</span>ls<span class="w"> </span>output/*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
output/_SUCCESS  output/part-00000
</pre></div></div>
</div>
</section>
<section id="Paso-9-—-Limpieza-del-HDFS">
<h2>Paso 9 — Limpieza del HDFS<a class="headerlink" href="#Paso-9-—-Limpieza-del-HDFS" title="Enlace permanente a este encabezado"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Se elimina el directorio de salida en el hdfs si existe</span>
<span class="c1">#</span>
<span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-rm<span class="w"> </span>input/*
<span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-rm<span class="w"> </span>output/*
<span class="o">!</span>hadoop<span class="w"> </span>fs<span class="w"> </span>-rmdir<span class="w"> </span>input<span class="w"> </span>output
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Deleted input/text0.txt
Deleted input/text1.txt
Deleted input/text2.txt
Deleted output/_SUCCESS
Deleted output/part-00000
</pre></div></div>
</div>
</section>
<section id="Limpieza-de-la-máquina-local">
<h2>Limpieza de la máquina local<a class="headerlink" href="#Limpieza-de-la-máquina-local" title="Enlace permanente a este encabezado"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>rm<span class="w"> </span>reducer.py<span class="w"> </span>mapper.py
<span class="o">!</span>rm<span class="w"> </span>-rf<span class="w"> </span>input<span class="w"> </span>output
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2022, Santiago Arboleda.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>